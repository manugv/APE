# Time
StartDate: 2019-9-3   # year-month-day
EndDate: 2018-9-3

# Satellite data directory
SatelliteDir: '/nfs/Tropomi/lv2/Operational/CO/'
# Output directory
OutputDir: '/data/manugv/outputdir/'

Source: 'Industrial'    # Fire, Industrial

Industrial:
  Source: [52.56, 39.63]  # [lat, lon]
  Source_name: 'xplant'

PlumeDetection:
  Flag: True
  
EmissionEstimation:
  Flag: True
  Method: "Divergence"  # CFM, Divergence

  Divergence:
    Name: vel100
    Plumeheight: 100
    HeightFromSurface: True
    Flow:
      Dir: '/nfs/METEO/ERA5/'
      # Needed if velocity fields at height different from 10/100m
      FlowField: 'velocity_qt.nc'  # suffix for file
      SurfacePresGeop: 'zlnsp.nc'  # suffix for file
      ModelLevels: [81, 137]

  CFM:
    Plumeheight:
      Type: Constant   # Constant, Varying
      Height: 100      # injht or 10 or 100 in m
      HeightFromSurface: True  # height from the surface
      Name: Const100   # name of the emission variable in the output file
      # if height is 'injht' then provide GFAS Directory
      InjectionHeightDir: 'dir/GFAS/'
    
    # if the velocity fields already exist
    Flow:
      Dir: '/nfs/METEO/ERA5/'
      # Needed if velocity fields at height different from 10/100m
      FlowField: 'velocity_qt.nc'  # suffix for file
      SurfacePresGeop: 'zlnsp.nc'  # suffix for file
      ModelLevels: [81, 137]

    # If plume height is varying then
    Simulation:
      Time:
        TotalTime: {Hour: 6, Minute: 00}
        TimeStep: {Second: 30}
        SaveDataTimeStep: {Minute: 10}
      
      Dispersion:
        Type: 3d                      # 3d
        Model: Forward                # Forward or Backward
        Method: Euler                 # Euler TODO: RK3
      
      MultipleParticleRelease:
        Flag: True
        TimeStep: {Minute: 2}

      ParticleSplitting:
        Split: False                   # True for split
        SplitTime: {Second: 3600}      # in seconds

      TrajectoriesToConcentrations:
        Convert: False
        StartSaveTime: {Hour: 2}        # w.r.t simulation start
        TimeStep: {Minute: 30}
        AveragingTime: {Minute: 10}     # Concentration time is end point
        GridResolution: [0.05,0.05,50]  # [deg, deg, mts]

      # output particles dir
      OutputParticlesDir: 'dir/something/particles_full/'
    
